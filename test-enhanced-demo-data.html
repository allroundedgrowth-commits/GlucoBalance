<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Demo Data Test - GlucoBalance</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .header h1 {
            color: #333;
            margin: 0;
            font-size: 2.5em;
        }
        
        .header p {
            color: #666;
            margin: 10px 0 0 0;
            font-size: 1.1em;
        }
        
        .demo-info {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #4CAF50;
        }
        
        .demo-info h3 {
            margin: 0 0 10px 0;
            color: #2e7d32;
        }
        
        .demo-info p {
            margin: 5px 0;
            color: #388e3c;
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #007bff;
            transition: transform 0.2s;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .card h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 1.3em;
        }
        
        .card-content {
            color: #666;
            line-height: 1.6;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .metric:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            font-weight: 500;
            color: #555;
        }
        
        .metric-value {
            font-weight: bold;
            color: #007bff;
        }
        
        .status-excellent {
            color: #28a745;
        }
        
        .status-good {
            color: #ffc107;
        }
        
        .status-needs-attention {
            color: #dc3545;
        }
        
        .actions {
            text-align: center;
            margin: 30px 0;
        }
        
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            margin: 0 10px;
            transition: background 0.2s;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-success:hover {
            background: #1e7e34;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-warning:hover {
            background: #e0a800;
        }
        
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        
        .log-entry:last-child {
            border-bottom: none;
        }
        
        .log-success {
            color: #28a745;
        }
        
        .log-error {
            color: #dc3545;
        }
        
        .log-info {
            color: #007bff;
        }
        
        .insights-list {
            list-style: none;
            padding: 0;
        }
        
        .insights-list li {
            background: #e3f2fd;
            margin: 8px 0;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #2196f3;
        }
        
        .achievements-list {
            list-style: none;
            padding: 0;
        }
        
        .achievements-list li {
            background: #e8f5e8;
            margin: 8px 0;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #4caf50;
        }
        
        .trends-chart {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            text-align: center;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü©∫ Enhanced Demo Data Test</h1>
            <p>Testing comprehensive demo data for demo@glucobalance.com</p>
        </div>
        
        <div class="demo-info">
            <h3>üìß Demo Account Information</h3>
            <p><strong>Email:</strong> demo@glucobalance.com</p>
            <p><strong>Password:</strong> demo123</p>
            <p><strong>Data Period:</strong> 90 days of comprehensive health tracking</p>
        </div>
        
        <div class="actions">
            <button class="btn btn-success" onclick="generateDemoData()">üöÄ Generate Enhanced Demo Data</button>
            <button class="btn" onclick="testDashboardCards()">üîç Test Dashboard Cards</button>
            <button class="btn btn-warning" onclick="clearDemoData()">üóëÔ∏è Clear Demo Data</button>
        </div>
        
        <div class="cards-grid">
            <!-- Risk Status Card -->
            <div class="card">
                <h3>üéØ Risk Status</h3>
                <div class="card-content" id="risk-status-content">
                    <div class="metric">
                        <span class="metric-label">Current Score:</span>
                        <span class="metric-value" id="risk-score">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Category:</span>
                        <span class="metric-value" id="risk-category">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Trend:</span>
                        <span class="metric-value status-excellent" id="risk-trend">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Improvement:</span>
                        <span class="metric-value status-excellent" id="risk-improvement">Loading...</span>
                    </div>
                </div>
            </div>
            
            <!-- Mood Tracker Card -->
            <div class="card">
                <h3>üíô Mood Tracker</h3>
                <div class="card-content" id="mood-tracker-content">
                    <div class="metric">
                        <span class="metric-label">Current Mood:</span>
                        <span class="metric-value" id="current-mood">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Average Mood:</span>
                        <span class="metric-value" id="average-mood">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Total Entries:</span>
                        <span class="metric-value" id="mood-entries">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Streak Days:</span>
                        <span class="metric-value status-excellent" id="mood-streak">Loading...</span>
                    </div>
                </div>
            </div>
            
            <!-- Nutrition Snapshot Card -->
            <div class="card">
                <h3>üçé Nutrition Snapshot</h3>
                <div class="card-content" id="nutrition-snapshot-content">
                    <div class="metric">
                        <span class="metric-label">Current Plan:</span>
                        <span class="metric-value" id="current-plan">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Adherence Rate:</span>
                        <span class="metric-value status-excellent" id="adherence-rate">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Plans Completed:</span>
                        <span class="metric-value" id="plans-completed">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Weight Loss:</span>
                        <span class="metric-value status-excellent" id="weight-loss">Loading...</span>
                    </div>
                </div>
            </div>
            
            <!-- AI Health Insights Card -->
            <div class="card">
                <h3>ü§ñ AI Health Insights</h3>
                <div class="card-content" id="ai-insights-content">
                    <div class="metric">
                        <span class="metric-label">Total Insights:</span>
                        <span class="metric-value" id="total-insights">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Unread:</span>
                        <span class="metric-value" id="unread-insights">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Overall Progress:</span>
                        <span class="metric-value status-excellent" id="overall-progress">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Latest Insight:</span>
                        <span class="metric-value" id="latest-insight">Loading...</span>
                    </div>
                </div>
            </div>
            
            <!-- Health Trends Card -->
            <div class="card">
                <h3>üìà Health Trends</h3>
                <div class="card-content" id="health-trends-content">
                    <div class="trends-chart">
                        <p><strong>90-Day Health Trends</strong></p>
                        <div class="metric">
                            <span class="metric-label">Risk Score:</span>
                            <span class="metric-value status-excellent" id="risk-trend-data">Loading...</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Mood:</span>
                            <span class="metric-value status-excellent" id="mood-trend-data">Loading...</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Weight:</span>
                            <span class="metric-value status-good" id="weight-trend-data">Loading...</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Activity:</span>
                            <span class="metric-value status-excellent" id="activity-trend-data">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Health Summary Card -->
            <div class="card">
                <h3>üìä Health Summary</h3>
                <div class="card-content" id="health-summary-content">
                    <div class="metric">
                        <span class="metric-label">Overall Score:</span>
                        <span class="metric-value status-excellent" id="overall-score">Loading...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Status:</span>
                        <span class="metric-value status-excellent" id="health-status">Loading...</span>
                    </div>
                    <div style="margin-top: 15px;">
                        <strong>Key Achievements:</strong>
                        <ul class="achievements-list" id="achievements-list">
                            <li>Loading achievements...</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="log" id="log">
            <div class="log-entry log-info">Ready to test enhanced demo data...</div>
        </div>
    </div>

    <!-- Include the enhanced demo data script -->
    <script src="js/enhanced-demo-data.js"></script>
    
    <script>
        let logContainer = document.getElementById('log');
        
        function addLog(message, type = 'info') {
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        async function generateDemoData() {
            addLog('üöÄ Starting enhanced demo data generation...', 'info');
            
            try {
                const success = await window.enhancedDemoDataGenerator.generateAllEnhancedData();
                
                if (success) {
                    addLog('‚úÖ Enhanced demo data generated successfully!', 'success');
                    setTimeout(() => {
                        testDashboardCards();
                    }, 1000);
                } else {
                    addLog('‚ùå Failed to generate enhanced demo data', 'error');
                }
            } catch (error) {
                addLog(`‚ùå Error generating demo data: ${error.message}`, 'error');
            }
        }
        
        function testDashboardCards() {
            addLog('üîç Testing dashboard cards with demo data...', 'info');
            
            try {
                // Test Risk Status
                testRiskStatus();
                
                // Test Mood Tracker
                testMoodTracker();
                
                // Test Nutrition Snapshot
                testNutritionSnapshot();
                
                // Test AI Health Insights
                testAIHealthInsights();
                
                // Test Health Trends
                testHealthTrends();
                
                // Test Health Summary
                testHealthSummary();
                
                addLog('‚úÖ All dashboard cards tested successfully!', 'success');
            } catch (error) {
                addLog(`‚ùå Error testing dashboard cards: ${error.message}`, 'error');
            }
        }
        
        function testRiskStatus() {
            const userId = 'demo-user-glucobalance';
            const riskStatus = JSON.parse(localStorage.getItem(`current-risk-status-${userId}`) || '{}');
            const assessments = JSON.parse(localStorage.getItem(`risk-assessments-${userId}`) || '[]');
            
            if (riskStatus.score) {
                document.getElementById('risk-score').textContent = riskStatus.score;
                document.getElementById('risk-category').textContent = riskStatus.category;
                document.getElementById('risk-trend').textContent = riskStatus.trend;
                document.getElementById('risk-improvement').textContent = riskStatus.improvement;
                addLog(`‚úÖ Risk Status: Score ${riskStatus.score}, ${riskStatus.category}`, 'success');
            } else {
                addLog('‚ö†Ô∏è Risk status data not found', 'error');
            }
        }
        
        function testMoodTracker() {
            const userId = 'demo-user-glucobalance';
            const moodSummary = JSON.parse(localStorage.getItem(`mood-tracker-summary-${userId}`) || '{}');
            
            if (moodSummary.currentMood) {
                document.getElementById('current-mood').textContent = `${moodSummary.currentMood}/5`;
                document.getElementById('average-mood').textContent = `${moodSummary.averageMood}/5`;
                document.getElementById('mood-entries').textContent = moodSummary.totalEntries;
                document.getElementById('mood-streak').textContent = `${moodSummary.streakDays} days`;
                addLog(`‚úÖ Mood Tracker: ${moodSummary.totalEntries} entries, ${moodSummary.streakDays} day streak`, 'success');
            } else {
                addLog('‚ö†Ô∏è Mood tracker data not found', 'error');
            }
        }
        
        function testNutritionSnapshot() {
            const userId = 'demo-user-glucobalance';
            const nutritionSnapshot = JSON.parse(localStorage.getItem(`nutrition-snapshot-${userId}`) || '{}');
            
            if (nutritionSnapshot.currentPlan) {
                document.getElementById('current-plan').textContent = nutritionSnapshot.currentPlan;
                document.getElementById('adherence-rate').textContent = `${nutritionSnapshot.adherenceRate}%`;
                document.getElementById('plans-completed').textContent = nutritionSnapshot.plansCompleted;
                document.getElementById('weight-loss').textContent = nutritionSnapshot.weightLoss;
                addLog(`‚úÖ Nutrition: ${nutritionSnapshot.adherenceRate}% adherence, ${nutritionSnapshot.plansCompleted} plans completed`, 'success');
            } else {
                addLog('‚ö†Ô∏è Nutrition snapshot data not found', 'error');
            }
        }
        
        function testAIHealthInsights() {
            const userId = 'demo-user-glucobalance';
            const aiSummary = JSON.parse(localStorage.getItem(`ai-insights-summary-${userId}`) || '{}');
            
            if (aiSummary.totalInsights) {
                document.getElementById('total-insights').textContent = aiSummary.totalInsights;
                document.getElementById('unread-insights').textContent = aiSummary.unreadCount;
                document.getElementById('overall-progress').textContent = aiSummary.overallProgress;
                document.getElementById('latest-insight').textContent = aiSummary.latestInsight?.title || 'None';
                addLog(`‚úÖ AI Insights: ${aiSummary.totalInsights} total, ${aiSummary.unreadCount} unread`, 'success');
            } else {
                addLog('‚ö†Ô∏è AI insights data not found', 'error');
            }
        }
        
        function testHealthTrends() {
            const userId = 'demo-user-glucobalance';
            const healthTrends = JSON.parse(localStorage.getItem(`health-trends-${userId}`) || '{}');
            
            if (healthTrends.trends) {
                document.getElementById('risk-trend-data').textContent = `${healthTrends.trends.riskScore.improvement} ${healthTrends.trends.riskScore.trend}`;
                document.getElementById('mood-trend-data').textContent = `${healthTrends.trends.mood.improvement} ${healthTrends.trends.mood.trend}`;
                document.getElementById('weight-trend-data').textContent = `${healthTrends.trends.weight.improvement} ${healthTrends.trends.weight.trend}`;
                document.getElementById('activity-trend-data').textContent = `${healthTrends.trends.activity.improvement} ${healthTrends.trends.activity.trend}`;
                addLog(`‚úÖ Health Trends: 90-day data with correlations`, 'success');
            } else {
                addLog('‚ö†Ô∏è Health trends data not found', 'error');
            }
        }
        
        function testHealthSummary() {
            const userId = 'demo-user-glucobalance';
            const healthSummary = JSON.parse(localStorage.getItem(`health-summary-${userId}`) || '{}');
            
            if (healthSummary.overallScore) {
                document.getElementById('overall-score').textContent = `${healthSummary.overallScore}/100`;
                document.getElementById('health-status').textContent = healthSummary.status;
                
                const achievementsList = document.getElementById('achievements-list');
                achievementsList.innerHTML = '';
                healthSummary.keyAchievements.forEach(achievement => {
                    const li = document.createElement('li');
                    li.textContent = achievement;
                    achievementsList.appendChild(li);
                });
                
                addLog(`‚úÖ Health Summary: ${healthSummary.overallScore}/100 score, ${healthSummary.keyAchievements.length} achievements`, 'success');
            } else {
                addLog('‚ö†Ô∏è Health summary data not found', 'error');
            }
        }
        
        function clearDemoData() {
            addLog('üóëÔ∏è Clearing demo data...', 'info');
            
            const userId = 'demo-user-glucobalance';
            const keysToRemove = [
                `risk-assessments-${userId}`,
                `glucobalance-assessments-${userId}`,
                `RiskAssessments-${userId}`,
                `current-risk-status-${userId}`,
                `mood-entries-${userId}`,
                `glucobalance-moods-${userId}`,
                `MentalHealthLogs-${userId}`,
                `mood-tracker-summary-${userId}`,
                `nutrition-plans-${userId}`,
                `glucobalance-nutrition-${userId}`,
                `nutrition-snapshot-${userId}`,
                `ai-insights-${userId}`,
                `glucobalance-insights-${userId}`,
                `ai-health-insights-${userId}`,
                `ai-insights-summary-${userId}`,
                `health-trends-${userId}`,
                `glucobalance-trends-${userId}`,
                `health-summary-${userId}`,
                `glucobalance-summary-${userId}`,
                `progress-data-${userId}`,
                `glucobalance-progress-${userId}`,
                `doctor-reports-${userId}`,
                `glucobalance-reports-${userId}`,
                `notifications-${userId}`,
                `glucobalance-user-${userId}`,
                `user-profile-${userId}`
            ];
            
            keysToRemove.forEach(key => {
                localStorage.removeItem(key);
            });
            
            // Clear from users array
            const users = JSON.parse(localStorage.getItem('glucobalance-users') || '[]');
            const filteredUsers = users.filter(u => u.email !== 'demo@glucobalance.com');
            localStorage.setItem('glucobalance-users', JSON.stringify(filteredUsers));
            
            addLog('‚úÖ Demo data cleared successfully', 'success');
            
            // Reset card displays
            document.querySelectorAll('.metric-value').forEach(el => {
                el.textContent = 'Cleared';
            });
            
            document.getElementById('achievements-list').innerHTML = '<li>Data cleared</li>';
        }
        
        // Auto-generate data on page load
        document.addEventListener('DOMContentLoaded', () => {
            addLog('üéØ Page loaded, ready to test enhanced demo data', 'info');
            
            // Check if data already exists
            const userId = 'demo-user-glucobalance';
            const existingData = localStorage.getItem(`current-risk-status-${userId}`);
            
            if (existingData) {
                addLog('üìä Existing demo data found, testing dashboard cards...', 'info');
                testDashboardCards();
            } else {
                addLog('üìù No existing demo data found, click "Generate Enhanced Demo Data" to create it', 'info');
            }
        });
    </script>
</body>
</html>