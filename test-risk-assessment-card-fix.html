<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risk Assessment Card Fix Test - GlucoBalance</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/landing-page-enhanced.css">
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-header {
            background: white;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .test-header h1 {
            color: #1f2937;
            margin: 0 0 10px 0;
            font-size: 2rem;
            font-weight: 700;
        }
        
        .test-header p {
            color: #64748b;
            margin: 0;
        }
        
        .test-section {
            background: white;
            margin-bottom: 30px;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .test-section-header {
            background: linear-gradient(135deg, #007FFF, #0066CC);
            color: white;
            padding: 20px 30px;
            font-size: 18px;
            font-weight: 600;
        }
        
        .test-section-content {
            padding: 30px;
        }
        
        .hero-section {
            background: linear-gradient(135deg, #007FFF, #0066CC);
            color: white;
            padding: 60px 30px;
            border-radius: 16px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .hero-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .hero-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 40px;
        }
        
        .hero-cta {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .hero-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 16px 32px;
            border-radius: 12px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            min-width: 200px;
            justify-content: center;
            cursor: pointer;
            border: none;
            font-size: 1rem;
        }
        
        .hero-btn.primary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .hero-btn.primary:hover {
            background: white;
            color: #007FFF;
            transform: translateY(-2px);
        }
        
        .hero-btn.secondary {
            background: transparent;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }
        
        .hero-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .features-section {
            padding: 40px 0;
        }
        
        .section-title {
            text-align: center;
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 40px;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .feature-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            border: 2px solid transparent;
        }
        
        .feature-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0, 127, 255, 0.2);
            border-color: #007FFF;
        }
        
        .feature-card.clickable {
            cursor: pointer;
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }
        
        .feature-card h3 {
            color: #1f2937;
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .feature-card p {
            color: #64748b;
            line-height: 1.6;
            margin: 0;
        }
        
        .card-arrow {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.5rem;
            color: #007FFF;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .feature-card:hover .card-arrow {
            opacity: 1;
        }
        
        .test-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .test-btn {
            background: linear-gradient(135deg, #007FFF, #0066CC);
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 127, 255, 0.3);
        }
        
        .test-btn.success {
            background: linear-gradient(135deg, #10B981, #059669);
        }
        
        .test-btn.warning {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }
        
        .test-log {
            background: #1f2937;
            color: #e5e7eb;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-success { background: #10B981; }
        .status-error { background: #EF4444; }
        .status-warning { background: #F59E0B; }
        .status-info { background: #3B82F6; }
        
        .cta-section {
            background: #f8fafc;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            margin: 30px 0;
        }
        
        .cta-text {
            font-size: 1.1rem;
            color: #64748b;
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üéØ Risk Assessment Card Fix Test</h1>
            <p>Testing that the risk assessment card launches the questionnaire directly</p>
        </div>

        <!-- Hero Section Test -->
        <div class="test-section">
            <div class="test-section-header">
                ü¶∏‚Äç‚ôÇÔ∏è Hero Section - Reference Implementation
            </div>
            <div class="test-section-content">
                <div class="hero-section">
                    <h1 class="hero-title">GlucoBalance</h1>
                    <p class="hero-subtitle">Your comprehensive companion for diabetes prevention</p>
                    
                    <div class="hero-cta">
                        <button class="hero-btn primary" onclick="testHeroRiskAssessment()">
                            <span class="btn-icon">üéØ</span>
                            Start Free Risk Assessment
                        </button>
                        <button class="hero-btn secondary" onclick="scrollToFeatures()">
                            <span class="btn-icon">üìã</span>
                            Explore Features
                        </button>
                    </div>
                </div>
                
                <p><strong>Expected Behavior:</strong> Hero button should launch the WHO/ADA questionnaire directly.</p>
            </div>
        </div>

        <!-- Features Section Test -->
        <div class="test-section">
            <div class="test-section-header">
                üéØ Features Section - Risk Assessment Card
            </div>
            <div class="test-section-content">
                <section class="features-section">
                    <h2 class="section-title">Comprehensive Health Management</h2>
                    <div class="features-grid">
                        <div class="feature-card clickable" data-prefetch-module="risk-assessment" data-feature="risk-assessment">
                            <div class="feature-icon">üéØ</div>
                            <h3>Risk Assessment</h3>
                            <p>WHO/ADA-compliant questionnaire with AI-powered insights</p>
                            <div class="card-arrow">‚Üí</div>
                        </div>

                        <div class="feature-card clickable" data-prefetch-module="nutrition-service" data-feature="nutrition">
                            <div class="feature-icon">üçé</div>
                            <h3>Nutrition Planning</h3>
                            <p>Personalized meal plans adapted to your local cuisine</p>
                            <div class="card-arrow">‚Üí</div>
                        </div>

                        <div class="feature-card clickable" data-prefetch-module="mental-health" data-feature="mental-health">
                            <div class="feature-icon">üíô</div>
                            <h3>Mental Health</h3>
                            <p>Daily mood tracking with AI-generated support</p>
                            <div class="card-arrow">‚Üí</div>
                        </div>

                        <div class="feature-card clickable" data-prefetch-module="progress-dashboard" data-feature="progress">
                            <div class="feature-icon">üìä</div>
                            <h3>Progress Tracking</h3>
                            <p>Visual insights and comprehensive health reports</p>
                            <div class="card-arrow">‚Üí</div>
                        </div>
                    </div>
                </section>

                <div class="cta-section">
                    <p class="cta-text">Click on the Risk Assessment card above - it should launch the questionnaire directly!</p>
                </div>
                
                <p><strong>Expected Behavior:</strong> Risk Assessment card should launch the WHO/ADA questionnaire directly, while other cards show feature modals.</p>
            </div>
        </div>

        <!-- Test Controls -->
        <div class="test-section">
            <div class="test-section-header">
                üß™ Test Controls
            </div>
            <div class="test-section-content">
                <div class="test-buttons">
                    <button class="test-btn" onclick="testRiskAssessmentCard()">
                        üéØ Test Risk Assessment Card
                    </button>
                    <button class="test-btn" onclick="testOtherFeatureCards()">
                        üìã Test Other Feature Cards
                    </button>
                    <button class="test-btn success" onclick="testDirectQuestionnaire()">
                        ‚ö° Launch Questionnaire Directly
                    </button>
                    <button class="test-btn warning" onclick="runAllTests()">
                        üöÄ Run All Tests
                    </button>
                </div>
                
                <div class="test-log" id="test-log">
                    <div><span class="status-info">‚óè</span> Risk Assessment Card Fix Test initialized</div>
                    <div><span class="status-info">‚óè</span> Ready to test feature card functionality</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Scripts -->
    <script src="js/app.js"></script>
    <script src="js/database.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/risk-assessment.js"></script>
    <script src="js/landing-page-enhanced.js"></script>

    <script>
        // Test Framework
        class RiskAssessmentCardTester {
            constructor() {
                this.testResults = [];
                this.init();
            }

            init() {
                this.log('üéØ Risk Assessment Card Tester initialized', 'info');
                
                // Initialize the enhanced landing page manager
                if (!window.enhancedLandingPageManager) {
                    window.enhancedLandingPageManager = new EnhancedLandingPageManager();
                    this.log('‚úÖ Enhanced Landing Page Manager initialized', 'success');
                } else {
                    this.log('‚úÖ Enhanced Landing Page Manager already available', 'success');
                }
            }

            log(message, type = 'info') {
                const logElement = document.getElementById('test-log');
                const timestamp = new Date().toLocaleTimeString();
                const statusClass = `status-${type}`;
                
                logElement.innerHTML += `<div><span class="${statusClass}">‚óè</span> [${timestamp}] ${message}</div>`;
                logElement.scrollTop = logElement.scrollHeight;
                console.log(message);
            }

            testRiskAssessmentCardClick() {
                this.log('üéØ Testing risk assessment card click...', 'info');
                
                const riskCard = document.querySelector('[data-feature="risk-assessment"]');
                if (!riskCard) {
                    this.log('‚ùå Risk assessment card not found', 'error');
                    return false;
                }
                
                // Simulate click
                try {
                    riskCard.click();
                    this.log('‚úÖ Risk assessment card clicked successfully', 'success');
                    
                    // Check if questionnaire was launched
                    setTimeout(() => {
                        const assessmentOverlay = document.getElementById('risk-assessment-container');
                        if (assessmentOverlay) {
                            this.log('‚úÖ WHO/ADA questionnaire launched successfully!', 'success');
                        } else {
                            this.log('‚ö†Ô∏è Questionnaire not found - checking for other modals', 'warning');
                            
                            const featureModal = document.getElementById('feature-modal');
                            if (featureModal && featureModal.classList.contains('active')) {
                                this.log('‚ùå Feature modal opened instead of questionnaire', 'error');
                            } else {
                                this.log('‚ö†Ô∏è No modal or questionnaire detected', 'warning');
                            }
                        }
                    }, 500);
                    
                    return true;
                } catch (error) {
                    this.log(`‚ùå Error clicking risk assessment card: ${error.message}`, 'error');
                    return false;
                }
            }

            testOtherFeatureCards() {
                this.log('üìã Testing other feature cards...', 'info');
                
                const otherCards = document.querySelectorAll('[data-feature]:not([data-feature="risk-assessment"])');
                if (otherCards.length === 0) {
                    this.log('‚ùå No other feature cards found', 'error');
                    return false;
                }
                
                let testsPassed = 0;
                otherCards.forEach((card, index) => {
                    const feature = card.dataset.feature;
                    this.log(`Testing ${feature} card...`, 'info');
                    
                    try {
                        card.click();
                        
                        setTimeout(() => {
                            const featureModal = document.getElementById('feature-modal');
                            if (featureModal && featureModal.classList.contains('active')) {
                                this.log(`‚úÖ ${feature} card opened feature modal correctly`, 'success');
                                testsPassed++;
                                
                                // Close modal for next test
                                const closeBtn = document.getElementById('modal-close');
                                if (closeBtn) closeBtn.click();
                            } else {
                                this.log(`‚ùå ${feature} card did not open feature modal`, 'error');
                            }
                        }, 200 * (index + 1));
                        
                    } catch (error) {
                        this.log(`‚ùå Error testing ${feature} card: ${error.message}`, 'error');
                    }
                });
                
                setTimeout(() => {
                    this.log(`üìä Other feature cards test completed: ${testsPassed}/${otherCards.length} passed`, testsPassed === otherCards.length ? 'success' : 'warning');
                }, 1000);
                
                return true;
            }

            testDirectQuestionnaire() {
                this.log('‚ö° Testing direct questionnaire launch...', 'info');
                
                try {
                    if (window.enhancedLandingPageManager && typeof window.enhancedLandingPageManager.startRiskAssessment === 'function') {
                        window.enhancedLandingPageManager.startRiskAssessment();
                        this.log('‚úÖ Direct questionnaire launch method called', 'success');
                        
                        setTimeout(() => {
                            const assessmentOverlay = document.getElementById('risk-assessment-container');
                            if (assessmentOverlay) {
                                this.log('‚úÖ WHO/ADA questionnaire launched directly!', 'success');
                            } else {
                                this.log('‚ùå Direct questionnaire launch failed', 'error');
                            }
                        }, 500);
                        
                        return true;
                    } else {
                        this.log('‚ùå startRiskAssessment method not available', 'error');
                        return false;
                    }
                } catch (error) {
                    this.log(`‚ùå Error in direct questionnaire launch: ${error.message}`, 'error');
                    return false;
                }
            }

            runAllTests() {
                this.log('üöÄ Running comprehensive test suite...', 'info');
                
                setTimeout(() => this.testRiskAssessmentCardClick(), 100);
                setTimeout(() => this.testOtherFeatureCards(), 1000);
                setTimeout(() => this.testDirectQuestionnaire(), 2000);
                
                setTimeout(() => {
                    this.log('üéâ All tests completed!', 'success');
                    this.log('üìä Check the results above to verify functionality', 'info');
                }, 3000);
            }
        }

        // Initialize tester
        const cardTester = new RiskAssessmentCardTester();

        // Test Functions (called by buttons)
        function testRiskAssessmentCard() {
            cardTester.testRiskAssessmentCardClick();
        }

        function testOtherFeatureCards() {
            cardTester.testOtherFeatureCards();
        }

        function testDirectQuestionnaire() {
            cardTester.testDirectQuestionnaire();
        }

        function runAllTests() {
            cardTester.runAllTests();
        }

        function testHeroRiskAssessment() {
            cardTester.log('ü¶∏‚Äç‚ôÇÔ∏è Hero risk assessment button clicked', 'info');
            if (window.enhancedLandingPageManager) {
                window.enhancedLandingPageManager.startRiskAssessment();
            } else {
                cardTester.log('‚ùå Enhanced Landing Page Manager not available', 'error');
            }
        }

        function scrollToFeatures() {
            cardTester.log('üìã Scrolling to features section', 'info');
            document.querySelector('.features-section').scrollIntoView({ behavior: 'smooth' });
        }

        // Auto-run basic test after page load
        setTimeout(() => {
            cardTester.log('üîÑ Running automatic functionality check...', 'info');
            
            // Check if risk assessment card exists
            const riskCard = document.querySelector('[data-feature="risk-assessment"]');
            if (riskCard) {
                cardTester.log('‚úÖ Risk assessment card found in DOM', 'success');
            } else {
                cardTester.log('‚ùå Risk assessment card not found in DOM', 'error');
            }
            
            // Check if enhanced landing page manager is available
            if (window.enhancedLandingPageManager) {
                cardTester.log('‚úÖ Enhanced Landing Page Manager available', 'success');
            } else {
                cardTester.log('‚ùå Enhanced Landing Page Manager not available', 'error');
            }
            
            cardTester.log('‚ú® Ready for testing! Click the buttons above or the feature cards.', 'info');
        }, 1000);
    </script>
</body>
</html>